--- a/src/connection-editor/nm-connection-editor.c	2021-02-02 20:16:58.000000000 +0300
+++ b/src/connection-editor/nm-connection-editor.c	2024-03-27 10:40:21.659973489 +0300
@@ -153,6 +153,9 @@
 		sensitive = ce_polkit_button_get_authorized (CE_POLKIT_BUTTON (editor->ok_button));
 	}
 
+	gtk_widget_set_sensitive (editor->export_button, sensitive);
+	gtk_widget_set_sensitive (editor->ok_button, sensitive);
+
 	/* Cancel button is always sensitive */
 	gtk_widget_set_sensitive (GTK_WIDGET (editor->cancel_button), TRUE);
 
@@ -809,9 +812,18 @@
 		return;
 	}
 
+	self = info->self;
+
 	secrets = nm_remote_connection_get_secrets_finish (connection, result, &error);
+	if(error)
+	{
+		char *dbus_err = g_dbus_error_get_remote_error (error);
+		if(	   g_strcmp0 (dbus_err, "org.freedesktop.NetworkManager.Settings.PermissionDenied") == 0
+			|| g_error_matches(error, G_IO_ERROR, G_IO_ERROR_TIMED_OUT))
+			self->can_modify = false;
 
-	self = info->self;
+		g_free (dbus_err);
+	}
 
 	/* Complete this secrets request; completion can actually dispose of the
 	 * dialog if there was an error.
